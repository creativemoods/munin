munin-docker
=============

[![Build]][build_url]
[![Version]][tag_url]
[![Size]][tag_url]
[![Pulls]][hub_url]

Container image for a Munin server, optimized for a large number of hosts in an effective manner.

* `rrdcached` is used to be able to handle a large number of hosts

* `fcgi` is used for generation of graphs on demand and not cron

## Environment variables

* `NODES`

    Format `[group1;]node1:ip1[:port1] [group2;]node2:ip2[:port2]...`

* `SNMP_NODES`

    Format `[group1;]node1:commutiy1: [group2;]node2:community2:...`

    Check SNMP units directly from the container. Defaults to SNMP version 2c.

* `TZ`

    Time zone. Defaults to `UTC`.

## Exposed ports

* `80`

## Volumes

* `/etc/munin/munin-conf.d/`

    Configuration files included on runtime. The files `nodes.conf` and `snmp-nodes.conf` are generated by this container.

* `/etc/munin/plugin-conf.d/`

    Configuration files for plugins. The file `snmp_communities` is generated by this container, but custom changes will not be overwritten.

* `/var/lib/munin/`

    All RRD files and temporary files.

* `/var/log/munin/`

    Log files.

## How to use this container

Via `docker-compose`

```
version: "3.6"
services:
  munin:
    container_name: munin
    image: dockurr/docker-munin:latest
    environment:
      - "NODES=server1:10.0.0.101 server2:10.0.0.102"
      - "TZ=Europe/Berlin"
    ports:
      - "80:80/tcp"
    volumes:
      - "/munin/lib:/var/lib/munin"
      - "/munin/log:/var/log/munin"
      - "/munin/conf:/etc/munin/munin-conf.d"
      - "/munin/plugin:/etc/munin/plugin-conf.d"
    restart: "onfailure"
    stop_grace_period: 1m
```

Via docker `run`

```
docker run -d \
  -p 80:80 --name munin \
  -v /munin/lib:/var/lib/munin \
  -v /munin/log:/var/log/munin \
  -v /munin/conf:/etc/munin/munin-conf.d \
  -v /munin/plugin:/etc/munin/plugin-conf.d \
  -e NODES="server1:10.0.0.101 server2:10.0.0.102" \
  dockurr/docker-munin
```

Access container at `http://host/munin/`

[build_url]: https://github.com/dockur/docker-munin/
[hub_url]: https://hub.docker.com/r/dockurr/docker-munin
[tag_url]: https://hub.docker.com/r/dockurr/docker-munin/tags

[Build]: https://github.com/dockur/docker-munin/actions/workflows/build.yml/badge.svg
[Size]: https://img.shields.io/docker/image-size/dockurr/docker-munin/latest?color=066da5&label=size
[Pulls]: https://img.shields.io/docker/pulls/dockurr/docker-munin.svg?style=flat&label=pulls&logo=docker
[Version]: https://img.shields.io/docker/v/dockurr/docker-munin?arch=amd64&sort=date&color=066da5
